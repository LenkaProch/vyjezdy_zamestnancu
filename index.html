<!DOCTYPE html>
<html lang="cs">
<head>
  

  <meta charset="UTF-8">
  <title>Hodnocení žádosti o výjezd</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
  window.jsPDF = window.jspdf.jsPDF;

  window.robotoReady = false;

  fetch("Roboto-Regular.ttf")
    .then(response => response.arrayBuffer())
    .then(buffer => {
      const base64String = btoa(
        new Uint8Array(buffer).reduce((data, byte) => data + String.fromCharCode(byte), '')
      );

      const tempDoc = new jsPDF();
      tempDoc.addFileToVFS("Roboto-Regular.ttf", base64String);
      tempDoc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
      window.robotoReady = true;
    });
</script>


  
  <style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    max-width: 800px;
    margin: auto;
    padding: 2em;
    background-color: #ffffff;
    color: #333;
  }

  header {
    border-bottom: 3px solid #005EB8;
    padding-bottom: 1em;
    margin-bottom: 2em;
  }

  label {
    display: block;
    margin-top: 1.5em;
    font-weight: 600;
    color: #005EB8;
  }

  select, input[type=checkbox] {
    margin-top: 0.5em;
  }

  .result {
    font-size: 1.2em;
    margin-top: 2em;
    background: #E6F2FA;
    border-left: 5px solid #005EB8;
    padding: 1em;
  }

  button {
    margin-top: 2em;
    padding: 0.6em 1.5em;
    font-size: 1em;
    background-color: #005EB8;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  button:hover {
    background-color: #004a94;
  }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>
 

<body>
 <header style="display:flex; align-items:center; margin-bottom:2em;">
  <img src="logo_pef.png" alt="Logo PEF MENDELU" style="height:60px; margin-right:1em;">
  <h1 style="font-size:2.5rem; color:#005EB8; font-family:'Segoe UI', Arial, sans-serif; margin:0;">
    Formulář žádosti o výjezd
  </h1>
</header>

  <form id="scoreForm" style="padding:2em; border:1px solid #CCE0F4; border-radius:8px; background-color:#FAFCFF;">
<p>
  <label for="jmeno"><strong>Jméno a příjmení žadatele:</strong></label><br>
  <input type="text" name="jmeno" id="jmeno" style="width: 100%;" required>
</p>

    <label style="color: #005EB8; font-weight: 600;">1. Odborný přínos výjezdu</label>
    <p style="margin: 0.2em 0 0.8em 2.5em; font-size: 0.75em; color: #555;">
  Pouze jedna odpověď.
</p>
<div style="margin-left: 2.5em; color: #000000; font-size: 0.8em; line-height: 2;">
  <input type="radio" name="odborny" value="20" required> Výjezd přímo souvisí s řešením aktuálního grantového projektu zaměstnance.<br>
  <input type="radio" name="odborny" value="15"> Výjezd přímo navazuje na odbornou či výzkumnou činnost zaměstnance (článek, kniha, výuka), ale není součástí konkrétního projektu.<br>
  <input type="radio" name="odborny" value="8"> Výjezd slouží k obecnému profesnímu rozvoji bez jasné návaznosti na projekt či odbornou činnost zaměstnance.<br>
  <input type="radio" name="odborny" value="3"> Výjezd má jen okrajový nebo pasivní přínos, bez zřejmého dopadu na činnost pracovníka (např. pouze jako posluchač bez možnosti navázání spolupráce).<br>
</div>

    </label>

    <label style="color: #005EB8; font-weight: 600;">2. Role na zahraniční akci nebo instituci</label>
    <p style="margin: 0.2em 0 0.8em 2.5em; font-size: 0.75em; color: #555;">
  Pouze jedna odpověď.
</p>
<div style="margin-left: 2.5em; color: #000000; font-size: 0.8em; line-height: 2;">
  <input type="radio" name="aktivita" value="25" required> Keynote, moderace sekce, vystoupení na plenárním zasedání, networking na zahraniční instituci, prohlubování vztahů.<br>
  <input type="radio" name="aktivita" value="15"> Prezentace článku, přednáška.<br>
  <input type="radio" name="aktivita" value="10"> Prezentace posteru<br>
  <input type="radio" name="aktivita" value="0"> Bez aktivní účasti (pouze posluchač)<br>
</div>

    </label>

    <label style="color: #005EB8; font-weight: 600;">3. Očekávané výstupy výjezdu/přínos pro ústav</label>
    <p style="margin: 0.2em 0 0.8em 2.5em; font-size: 0.75em; color: #555;">
  Neomezený počet odpovědí.
</p>
<div style="margin-left: 2.5em; color: #000000; font-size: 0.8em; line-height: 2;">
  <input type="checkbox" name="vystup" value="20"> Návrh grantového projektu se zahraničním partnerem.<br>
  <input type="checkbox" name="vystup" value="10"> Memorandum of Understanding/mezinárodní spolupráce.<br>
  <input type="checkbox" name="vystup" value="10"> Článek ve WoS.<br>
  <input type="checkbox" name="vystup" value="5"> Článek ve Scopus, učební materiály, návrh grantu bez partnera.<br>
  <input type="checkbox" name="vystup" value="1"> Odborný článek (neimpakt.), sborník.<br>
  <label for="popis_vystupu" style="color: #005EB8; font-weight: 600; display:block; margin-top: 1.5em;">
  Specifikujte plánovaný přínos a časový harmonogram výstupů:
</label>
<textarea name="popis_vystupu" rows="5" style="width: 95%; margin-left: 2.5em; font-size: 0.9em;"></textarea>


</div>

    </label>

    <label style="color: #005EB8; font-weight: 600;">4. Počet výjezdů v posledních 2 letech</label>
    <p style="margin: 0.2em 0 0.8em 2.5em; font-size: 0.75em; color: #555;">
  Pouze jedna odpověď.
</p>
<div style="margin-left: 2.5em; color: #000000; font-size: 0.8em; line-height: 2;">
  <input type="radio" name="frekvence" value="15" required> Žádný výjezd<br>
  <input type="radio" name="frekvence" value="10"> 1–2 výjezdy<br>
  <input type="radio" name="frekvence" value="5"> 3 výjezdy<br>
  <input type="radio" name="frekvence" value="0"> 4 a více výjezdů<br>
</div>

    </label>

    <label style="color: #005EB8; font-weight: 600;">5. Prestiž akce, instituce nebo vazba na internacionalizaci</label>
    <p style="margin: 0.2em 0 0.8em 2.5em; font-size: 0.75em; color: #555;">
  Pouze jedna odpověď.
</p>
<div style="margin-left: 2.5em; color: #000000; font-size: 0.8em; line-height: 2;">
  <input type="radio" name="prestiž" value="10" required> Prestižní mezinárodní instituce/partnerství (strategický partner).<br>
  <input type="radio" name="prestiž" value="5"> Renomovaná akce nebo konference.<br>
  <input type="radio" name="prestiž" value="0"> Regionální nebo méně významná akce.<br>
</div>

    </label>

    <button type="button" onclick="calculateScore()">Odeslat</button>
  </form>

  <div id="result" class="result" style="display:none"></div>
<button id="downloadPdf" style="display:none; margin-top: 1em;" onclick="generatePDF()">Stáhnout jako PDF</button>


 <script>
  function calculateScore() {
    const form = document.forms.scoreForm;
const jmeno = form.jmeno.value.trim();

  if (!jmeno) {
    document.getElementById("result").innerText = ""; // smaž výsledek
    return; // přeruš výpočet
  }

  // ... dál pokračuješ počítáním
}
    // 1. Kontrola, že každá skupina radio buttonů má vybranou možnost
    const requiredRadioNames = ["odborny", "aktivita", "frekvence", "prestiž"];
    for (let name of requiredRadioNames) {
      const selected = form.querySelector(`input[name="${name}"]:checked`);
      if (!selected) {
        alert("Vyplňte prosím všechny povinné otázky (1, 2, 4 a 5).");
        return;
      }
    }

    // 2. Kontrola, že je zaškrtnuta alespoň jedna možnost u checkboxů (otázka 3)
    const vystupy = form.querySelectorAll('input[name="vystup"]:checked');
    if (vystupy.length === 0) {
      alert("Vyberte alespoň jednu možnost u otázky 3 (očekávané výstupy).");
      return;
    }

    // 3. Kontrola textového pole – nesmí být prázdné
    const popis = form.popis_vystupu.value.trim();
    if (popis === "") {
      alert("Specifikujte prosím přínos a časový harmonogram výstupů.");
      return;
    }

    // 4. Výpočet bodů
    let total = 0;
    total += parseInt(form.querySelector('input[name="odborny"]:checked').value);
    total += parseInt(form.querySelector('input[name="aktivita"]:checked').value);
    total += parseInt(form.querySelector('input[name="frekvence"]:checked').value);
    total += parseInt(form.querySelector('input[name="prestiž"]:checked').value);

    let vystupScore = 0;
    vystupy.forEach(v => vystupScore += parseInt(v.value));
    vystupScore = Math.min(vystupScore, 30);
    total += vystupScore;

    // 5. Výstup
    const resultBox = document.getElementById("result");
    resultBox.style.display = "block";
    resultBox.innerHTML = `<strong>Celkové skóre:</strong> ${total} bodů<br>` +
      (total >= 50
        ? "✅ Žádost může být zařazena do výběrového řízení."
        : "❌ Žádost nesplňuje minimální hranici pro výběrové řízení.");
    document.getElementById("downloadPdf").style.display = "inline-block";

  }
</script>

<script>
  async function generatePDF() {
    const { jsPDF } = window.jspdf;

    if (!window.robotoReady) {
      alert("Font Roboto ještě není načten. Zkuste to za pár vteřin.");
      return;
    }

    const doc = new jsPDF();
    doc.addFileToVFS("Roboto-Regular.ttf", window.robotoFont);
    doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
    doc.setFont("Roboto", "normal");
    doc.setFontSize(12);
    doc.setLineHeightFactor(1.8);

    const form = document.forms.scoreForm;

    const getCheckedValue = (name) =>
      form.querySelector(`input[name="${name}"]:checked`)?.nextSibling.textContent.trim() || "-";

    const vystupy = Array.from(form.querySelectorAll('input[name="vystup"]:checked'))
      .map(cb => cb.nextSibling.textContent.trim())
      .join("\n• ");

    const textPole = form.popis_vystupu.value.trim();
    const resultText = document.getElementById("result").innerText;

    const maxWidth = 180;
    let y = 20;

    function addTextBlock(label, content) {
      const lines = doc.splitTextToSize(`${label}\n${content}`, maxWidth);
      doc.text(lines, 15, y);
      y += lines.length * 9;
    }

    doc.setFont("Roboto", "bold");
doc.setFontSize(14);
doc.text("Hodnocení žádosti o výjezd", doc.internal.pageSize.getWidth() / 2, y, { align: "center" });
y += 15;
doc.setFont("Roboto", "normal");
doc.setFontSize(12);

    
    addTextBlock("1. Odborný přínos výjezdu:", `• ${getCheckedValue("odborny")}`);
    addTextBlock("2. Role na zahraniční akci nebo instituci:", `• ${getCheckedValue("aktivita")}`);
    addTextBlock("3. Očekávané výstupy výjezdu/přínos pro ústav:", vystupy ? `• ${vystupy}` : "• –");
    addTextBlock("Textový popis přínosu a harmonogram:", textPole || "–");
    addTextBlock("4. Počet výjezdů v posledních 2 letech:", `• ${getCheckedValue("frekvence")}`);
    addTextBlock("5. Prestiž akce, instituce nebo vazba na internacionalizaci:", `• ${getCheckedValue("prestiž")}`);
    doc.setFont("Roboto", "bold");
addTextBlock("Výsledek hodnocení:", resultText);
doc.setFont("Roboto", "normal");


    doc.save("hodnoceni-vyjezdu.pdf");
  }
</script>


<!-- TADY SE NAČTE FONT -->
 <script>
  window.jsPDF = window.jspdf.jsPDF;
  window.robotoReady = false;
  window.robotoFont = null;

  fetch("Roboto-Regular.ttf")
    .then(response => response.arrayBuffer())
    .then(buffer => {
      const base64String = btoa(
        new Uint8Array(buffer).reduce((data, byte) => data + String.fromCharCode(byte), "")
      );

      window.robotoFont = base64String;
      window.robotoReady = true;
    });
</script>


</body>
</html>
